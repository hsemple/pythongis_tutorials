<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>14. Terrain Analysis &mdash; Python GIS Tutorials 0.0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="15. Batch Processing &amp; Workflow Automation" href="workflow_automation.html" />
    <link rel="prev" title="13. Spatial Analysis" href="spatial_analysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Python GIS Tutorials
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">1. Setting up Development Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro_programs.html">2. Introduction to the Python Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="strings_lists_conditional.html">3. Strings and Lists</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditionals_and_looping.html">4. Conditional Statements and Looping</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">5. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="error_handling.html">6. Error Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_oriented_programming.html">7. Basic Concepts in Object Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="displaying_files.html">8. Reading and Displaying Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="map_projections.html">9. Map Projections</a></li>
<li class="toctree-l1"><a class="reference internal" href="attribute_and_spatial_queries.html">10. Attribute and Spatial Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="querying_rasters.html">11. Querying Rasters</a></li>
<li class="toctree-l1"><a class="reference internal" href="geocoding.html">12. Geocoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatial_analysis.html">13. Spatial Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">14. Terrain Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#displaying-dems">14.1. Displaying DEMS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hillshades">14.2. Hillshades</a></li>
<li class="toctree-l2"><a class="reference internal" href="#displaying-terrain-data-in-3d">14.3. Displaying Terrain Data in 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slope-mapping">14.4. Slope Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aspect-mapping">14.5. Aspect Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="#curvature-maps">14.6. Curvature Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-viewshed">14.7. Computing Viewshed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#watershed-delineation-using-pysheds">14.8. Watershed Delineation Using PySheds</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-gdal-command-line-utilities">14.9. Working with GDAL Command Line Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-gdal-commands-from-python">14.10. Running GDAL Commands from Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">14.11. Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resources">14.12. Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workflow_automation.html">15. Batch Processing &amp; Workflow Automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">16. Retrieving Data from APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="search_algorithms.html">17. Search Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="databases.html">18. Database Interaction and SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_scraping.html">19. Web Scraping and APIs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python GIS Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">14. </span>Terrain Analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/terrain_analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="terrain-analysis">
<h1><span class="section-number">14. </span>Terrain Analysis<a class="headerlink" href="#terrain-analysis" title="Permalink to this heading"></a></h1>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>There are many python libraries that are available for terrain analysis.  Below, I use Arcpy, RichDEM, Rasterio, GDAL and pysheds for basic terrain analysis.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="displaying-dems">
<h2><span class="section-number">14.1. </span>Displaying DEMS<a class="headerlink" href="#displaying-dems" title="Permalink to this heading"></a></h2>
<p>Terrain analysis starts with displaying digital elevation models.  We have touched on this topic before.  Below, a DEM of Stowe, VT is displayed with the RichDEM library.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">richdem</span> <span class="k">as</span> <span class="nn">rd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">LoadGDAL</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/Users/.../elevation/w001001.adf&#39;</span><span class="p">)</span>

<span class="n">rd</span><span class="o">.</span><span class="n">rdShow</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">ignore_colours</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">5.5</span><span class="p">))</span>
</pre></div>
</div>
<img alt="DEM Loaded with RichDEM" src="_images/stowe_dem_richdem.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="hillshades">
<h2><span class="section-number">14.2. </span>Hillshades<a class="headerlink" href="#hillshades" title="Permalink to this heading"></a></h2>
<p>Hillshades are used in terrain analysis to give elevation data a 3-dimensional appearance thereby making it easier to visualize variations in topography. Hillshades are also frequently used in GIS and Cartography as underlays to make other kinds of data more visually interesting. As shown in the illustration below, Google Maps use hillshades extensivelly to portray terrain features of the earth.</p>
<img alt="DEM Loaded with RichDEM" src="_images/google_hillshade_map.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Generate Hillshade with ArcPy</strong></p>
<p>The two scripts below show how to generate hillshade maps using ArcPy within ArcMap or ArcGIS Pro.</p>
<ol class="arabic simple">
<li><p>Run this script from the ArcPy Window.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arcpy.ia</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">out_hillshade_raster</span> <span class="o">=</span> <span class="n">Hillshade</span><span class="p">(</span><span class="s2">&quot;elevation.tif&quot;</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mf">0.3048</span><span class="p">)</span>
<span class="n">out_hillshade_raster</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;C:/arcpyExamples/outputs/hillshade.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>This example calculates the hillshade using IDLE or any other IDE</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the system modules</span>
<span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy.ia</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Set the analysis environments</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s2">&quot;C:/arcpyExamples/data&quot;</span>

<span class="c1"># Set the local variables</span>
<span class="n">in_dem</span> <span class="o">=</span> <span class="s2">&quot;elevation.tif&quot;</span>

<span class="c1"># Execute the Hillshade function</span>
<span class="n">out_hillshade_raster</span> <span class="o">=</span> <span class="n">Hillshade</span><span class="p">(</span><span class="n">in_dem</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mf">0.3048</span><span class="p">)</span>

<span class="c1"># Save the output</span>
<span class="n">out_hillshade_raster</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;C:/arcpyExamples/outputs/hillshade.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><em>Source</em>
<a class="reference external" href="https://pro.arcgis.com/en/pro-app/latest/arcpy/image-analyst/hillshade.htm">https://pro.arcgis.com/en/pro-app/latest/arcpy/image-analyst/hillshade.htm</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Generate Hillshade  using GDAL</strong></p>
<p>The code sample below shows the details of computing hillshade.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">gradient</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arctan</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arctan2</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sin</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">zeros</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">uint8</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>



<span class="k">def</span> <span class="nf">hillshade</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">angle_altitude</span><span class="p">):</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mf">2.</span> <span class="o">-</span> <span class="n">arctan</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
    <span class="n">aspect</span> <span class="o">=</span> <span class="n">arctan2</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">azimuthrad</span> <span class="o">=</span> <span class="n">azimuth</span><span class="o">*</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>
    <span class="n">altituderad</span> <span class="o">=</span> <span class="n">angle_altitude</span><span class="o">*</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.</span>


    <span class="n">shaded</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">altituderad</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>\
    <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">altituderad</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span>\
    <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">azimuthrad</span> <span class="o">-</span> <span class="n">aspect</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">255</span><span class="o">*</span><span class="p">(</span><span class="n">shaded</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>


<span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s1">&#39;/Users/semple/Desktop/topography/dem&#39;</span><span class="p">)</span>
<span class="n">band</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">band</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span>

<span class="n">hs_array</span> <span class="o">=</span> <span class="n">hillshade</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="mi">315</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">hs_array</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_earth&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Hillshade Calculated with GDAL" src="_images/stowe_gray_scale.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Generating Hillshade with Earthpy</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">earthpy</span> <span class="k">as</span> <span class="nn">et</span>
<span class="kn">import</span> <span class="nn">earthpy.spatial</span> <span class="k">as</span> <span class="nn">es</span>
<span class="kn">import</span> <span class="nn">earthpy.plot</span> <span class="k">as</span> <span class="nn">ep</span>


<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/.../topography/dem&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">elev</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="n">hillshade</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">elev</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">240</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ep</span><span class="o">.</span><span class="n">plot_bands</span><span class="p">(</span>
    <span class="n">hillshade</span><span class="p">,</span>
    <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Hillshade of Wayne County&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>For information in earthpy, see <a class="reference external" href="https://earthpy.readthedocs.io/en/latest/gallery_vignettes/plot_dem_hillshade.html#sphx-glr-gallery-vignettes-plot-dem-hillshade-py">https://earthpy.readthedocs.io/en/latest/gallery_vignettes/plot_dem_hillshade.html#sphx-glr-gallery-vignettes-plot-dem-hillshade-py</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Draping Elevation Data on Hillshade using Earthpy and Matplotlib</strong></p>
<p>In this example, both the elevation layer and the hillshade layer are displayed in a single figure and ax object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">earthpy</span> <span class="k">as</span> <span class="nn">et</span>
<span class="kn">import</span> <span class="nn">earthpy.spatial</span> <span class="k">as</span> <span class="nn">es</span>
<span class="kn">import</span> <span class="nn">earthpy.plot</span> <span class="k">as</span> <span class="nn">ep</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>


<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/.../elevation/w001001.adf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">elevation</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="c1">#extent=[src.bounds[0], src.bounds[2], src.bounds[1], src.bounds[3]]</span>

<span class="n">hillshade</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">hillshade</span><span class="p">(</span><span class="n">elevation</span><span class="p">,</span> <span class="n">azimuth</span><span class="o">=</span><span class="mi">240</span><span class="p">,</span> <span class="n">altitude</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ep</span><span class="o">.</span><span class="n">plot_bands</span><span class="p">(</span>
    <span class="n">elevation</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">src_array</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Digital Elevation Model (DEM)</span><span class="se">\n</span><span class="s2"> overlayed on top of a hillshade&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ep</span><span class="o">.</span><span class="n">plot_bands</span><span class="p">(</span><span class="n">hillshade</span><span class="p">,</span>
              <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
              <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
              <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Elevation Layer Draped on Hillshade" src="_images/stowe_elevation_hillshade.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="displaying-terrain-data-in-3d">
<h2><span class="section-number">14.3. </span>Displaying Terrain Data in 3D<a class="headerlink" href="#displaying-terrain-data-in-3d" title="Permalink to this heading"></a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>3D Modeling Using Matplotlib</strong></p>
<p>It is possible to display terrain data in 3D using matplotlib, but this library by itself is too slow for most GIS data processing.  However, if you choose to use matplotlib, ensure that nodata values are not among the z-values that will be used to render the 3D model.</p>
<p>Below is a sample script to display terrain data in 3D using matplotlib.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">osgeo.gdal</span> <span class="k">as</span> <span class="nn">gdal</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Open the grid file using GDAL</span>
<span class="n">grid_file</span> <span class="o">=</span> <span class="s1">&#39;/Users/hsemple/Desktop/Python Scripts/stowe/StoweDEM2.tif&#39;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">grid_file</span><span class="p">)</span>

<span class="c1"># Get the grid&#39;s geotransform and projection information</span>
<span class="n">geotransform</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">GetGeoTransform</span><span class="p">()</span>

<span class="c1"># Get the grid size (number of rows and columns)</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">RasterYSize</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">RasterXSize</span>

<span class="c1"># Read the grid data as a numpy array</span>
<span class="n">grid_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span>

<span class="c1"># Get the NoData value from the grid metadata</span>
<span class="n">no_data_value</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">GetRasterBand</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">GetNoDataValue</span><span class="p">()</span>

<span class="c1"># Generate the x and y coordinates</span>
<span class="n">x_origin</span> <span class="o">=</span> <span class="n">geotransform</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y_origin</span> <span class="o">=</span> <span class="n">geotransform</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">pixel_width</span> <span class="o">=</span> <span class="n">geotransform</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pixel_height</span> <span class="o">=</span> <span class="n">geotransform</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

<span class="n">x_coords</span> <span class="o">=</span> <span class="n">x_origin</span> <span class="o">+</span> <span class="n">pixel_width</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">y_coords</span> <span class="o">=</span> <span class="n">y_origin</span> <span class="o">+</span> <span class="n">pixel_height</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

<span class="c1"># Convert the 2D grid into separate x, y, and z arrays</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_coords</span><span class="p">,</span> <span class="n">y_coords</span><span class="p">)</span>
<span class="c1">#z = grid_data</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">grid_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># Mask the NoData values in the z array</span>
<span class="n">z_masked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_values</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">no_data_value</span><span class="p">)</span>

<span class="c1"># Plot the coordinates</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="c1">#fig = plt.figure()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z_masked</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z_masked</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Elevation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Close the dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>Matplotlib often produces plots that have jagged peaks. These can be addressed by using some type of data smoothing algorithm.</p>
<img alt="3D Terrain Modeling" src="_images/matplotlib_terrain_modeling.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>3D Modeling Using Plotly</strong></p>
<p>The plotly library produces quick results when creating 3D DEMS. A sample script for using Plotly is presented below.  The script uses rasterio to load the DEM.  It also uses  Gaussian smoothing to the DEM dataa before converting to 3D.  This is important because at times the plot can have jagged peaks. If this is the case, apply higher sigma values.  The final plot is configured with axis titles and aspect ratio settings. The plot is saved as an HTML file using go_offline.plot(). Open the generated HTML file in a web browser to view the 3D model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">import</span> <span class="nn">plotly.offline</span> <span class="k">as</span> <span class="nn">go_offline</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter</span>

<span class="c1"># Load DEM data</span>
<span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;/Users/.../StoweDEM2.tif&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
    <span class="n">dem_data</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">nodata</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">nodata</span>

<span class="c1"># Set the no data values to NaN</span>
<span class="n">dem_data</span><span class="p">[</span><span class="n">dem_data</span> <span class="o">==</span> <span class="n">nodata</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="c1"># Apply Gaussian smoothing to the DEM data</span>
<span class="n">smoothed_dem</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">dem_data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Generate x, y coordinates for each pixel in the DEM</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">dem_data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">x_coords</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">src</span><span class="o">.</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">y_coords</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">xy</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">src</span><span class="o">.</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_coords</span><span class="p">,</span> <span class="n">y_coords</span><span class="p">)</span>

<span class="c1"># Create a 3D surface plot with the smoothed DEM data</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">smoothed_dem</span><span class="p">)])</span>

<span class="c1"># Configure the layout of the plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;3D Model from DEM (Smoothed)&quot;</span><span class="p">,</span>
    <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
        <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span>
        <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
        <span class="n">zaxis_title</span><span class="o">=</span><span class="s2">&quot;Elevation&quot;</span><span class="p">,</span>
        <span class="n">aspectratio</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">0.2</span><span class="p">),</span>
        <span class="n">aspectmode</span><span class="o">=</span><span class="s2">&quot;manual&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Save the plot as an HTML file</span>
<span class="n">go_offline</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;3d_model_smoothed20.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="3D Terrain Modeling" src="_images/plotly_3dModeling.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>3D Modeling Using ArcGIS Pro</strong></p>
<p>Generating 3D plots can be done very efficienty using the 3D engine of ArcGIS Pro or QGIS. We can write code to perform the 3D modeling in these software. Below is a sample script for converting a 2D DEM into a 3D DEM using Arcpy within ArcGIS Pro.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="c1"># Set the workspace and input DEM raster</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:\path\to\workspace&quot;</span>
<span class="n">input_dem</span> <span class="o">=</span> <span class="s2">&quot;input_dem.tif&quot;</span>

<span class="c1"># Output 3D feature class</span>
<span class="n">output_feature_class</span> <span class="o">=</span> <span class="s2">&quot;output_3d_dem&quot;</span>

<span class="c1"># Convert the 2D DEM to 3D using arcpy</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">RasterToGeometricNetwork</span><span class="p">(</span><span class="n">input_dem</span><span class="p">,</span> <span class="n">output_feature_class</span><span class="p">)</span>

<span class="c1"># Add the 3D DEM to the current map</span>
<span class="n">aprx</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">ArcGISProject</span><span class="p">(</span><span class="s2">&quot;CURRENT&quot;</span><span class="p">)</span>
<span class="n">map_view</span> <span class="o">=</span> <span class="n">aprx</span><span class="o">.</span><span class="n">activeView</span>
<span class="n">map_view</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">setExtent</span><span class="p">(</span><span class="n">map_view</span><span class="o">.</span><span class="n">getLayerExtent</span><span class="p">(</span><span class="n">output_feature_class</span><span class="p">))</span>
<span class="n">map_view</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">roll</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Set the camera roll angle to 0</span>

<span class="c1"># Refresh the map view to display the 3D DEM</span>
<span class="n">map_view</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="c1"># Save the project</span>
<span class="n">aprx</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Draping Orthophoto over 3D Plots</strong></p>
<p>Now, let’s look at a script that drapes an orthopho over the bare earth DEM model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arcpy</span>

<span class="c1"># Set the workspace and input DEM and orthophoto rasters</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:\path\to\workspace&quot;</span>
<span class="n">input_dem</span> <span class="o">=</span> <span class="s2">&quot;input_dem.tif&quot;</span>
<span class="n">orthophoto</span> <span class="o">=</span> <span class="s2">&quot;orthophoto.tif&quot;</span>

<span class="c1"># Output 3D feature class</span>
<span class="n">output_feature_class</span> <span class="o">=</span> <span class="s2">&quot;output_3d_dem&quot;</span>

<span class="c1"># Convert the 2D DEM to 3D using arcpy</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">RasterToGeometricNetwork</span><span class="p">(</span><span class="n">input_dem</span><span class="p">,</span> <span class="n">output_feature_class</span><span class="p">)</span>

<span class="c1"># Add the orthophoto as a raster layer to the current map</span>
<span class="n">aprx</span> <span class="o">=</span> <span class="n">arcpy</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">ArcGISProject</span><span class="p">(</span><span class="s2">&quot;CURRENT&quot;</span><span class="p">)</span>
<span class="n">map_view</span> <span class="o">=</span> <span class="n">aprx</span><span class="o">.</span><span class="n">activeView</span>
<span class="nb">map</span> <span class="o">=</span> <span class="n">map_view</span><span class="o">.</span><span class="n">map</span>
<span class="n">orthophoto_layer</span> <span class="o">=</span> <span class="nb">map</span><span class="o">.</span><span class="n">addRasterLayer</span><span class="p">(</span><span class="n">orthophoto</span><span class="p">)</span>

<span class="c1"># Add the 3D DEM to the current map</span>
<span class="n">dem_layer</span> <span class="o">=</span> <span class="nb">map</span><span class="o">.</span><span class="n">addFeatureClass</span><span class="p">(</span><span class="n">output_feature_class</span><span class="p">)</span>

<span class="c1"># Set the elevation surface to the 3D DEM</span>
<span class="nb">map</span><span class="o">.</span><span class="n">setElevationLayer</span><span class="p">(</span><span class="n">dem_layer</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Set the orthophoto as the base map layer</span>
<span class="nb">map</span><span class="o">.</span><span class="n">setBasemapLayer</span><span class="p">(</span><span class="n">orthophoto_layer</span><span class="p">)</span>

<span class="c1"># Refresh the map view to display the draped orthophoto on the 3D DEM</span>
<span class="n">map_view</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

<span class="c1"># Save the project</span>
<span class="n">aprx</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="slope-mapping">
<h2><span class="section-number">14.4. </span>Slope Mapping<a class="headerlink" href="#slope-mapping" title="Permalink to this heading"></a></h2>
<p><strong>Generate Slope Map with Arcpy</strong></p>
<p>The two scripts below show how to calculate slope using ArcPy.</p>
<ol class="arabic simple">
<li><p>Run this script from the ArcPy Window.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>
<span class="kn">from</span> <span class="nn">arcpy.sa</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s2">&quot;C:/.../topography&quot;</span>
<span class="n">outSlope</span> <span class="o">=</span> <span class="n">Slope</span><span class="p">(</span><span class="s2">&quot;dem&quot;</span><span class="p">,</span> <span class="s2">&quot;DEGREE&quot;</span><span class="p">,</span> <span class="mf">0.3043</span><span class="p">)</span>  <span class="c1"># Slope Tool</span>
<span class="n">outSlope</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;C:/Washtenaw/county/outslope01&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Run this script using Idle in Python 2.7 on a machine that has ArcMap, or from Jupyter Notebook in ArcGIS Pro.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import system modules</span>
<span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>
<span class="kn">from</span> <span class="nn">arcpy.sa</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Set environment settings</span>
<span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s2">&quot;C:/Washtenaw&quot;</span>

<span class="c1"># Set local variables</span>
<span class="n">inRaster</span> <span class="o">=</span> <span class="s2">&quot;C:/Washtenaw/county/washtenaw/topography/dem&quot;</span>
<span class="n">outMeasurement</span> <span class="o">=</span> <span class="s2">&quot;DEGREE&quot;</span>
<span class="n">zFactor</span> <span class="o">=</span> <span class="mf">0.3043</span>

<span class="c1"># Check out the ArcGIS Spatial Analyst extension license</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">CheckOutExtension</span><span class="p">(</span><span class="s2">&quot;Spatial&quot;</span><span class="p">)</span>

<span class="c1"># Execute Slope</span>
<span class="n">outSlope</span> <span class="o">=</span> <span class="n">Slope</span><span class="p">(</span><span class="n">inRaster</span><span class="p">,</span> <span class="n">outMeasurement</span><span class="p">,</span> <span class="n">zFactor</span><span class="p">)</span> <span class="c1"># Slope Tool</span>

<span class="c1"># Save the output</span>
<span class="n">outSlope</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;C:/Washtenaw/county/outslope02&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Calculate Slope from a DEM using PyQGIS</strong></p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/2g526ZoMu24" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Generate Slope using the RichDem Library</strong></p>
<p>First, install the RichDEM library. run the sample script below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">richdem</span> <span class="k">as</span> <span class="nn">rd</span>


<span class="c1">#Load Raster</span>
<span class="n">stowe_dem</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">LoadGDAL</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/Users/.../Stowe_DEM.tif&#39;</span><span class="p">)</span>

<span class="c1">#Perform Slope Calculation</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">TerrainAttribute</span><span class="p">(</span><span class="n">stowe_dem</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="s1">&#39;slope_riserun&#39;</span><span class="p">)</span>


<span class="c1">#Display slope map</span>
<span class="n">rd</span><span class="o">.</span><span class="n">rdShow</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
<img alt="Slope Map" src="_images/stowe_rich_dem_slope.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Generate Slope using GDAL</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">calculate_slope</span><span class="p">(</span><span class="n">DEM</span><span class="p">):</span>
      <span class="n">gdal</span><span class="o">.</span><span class="n">DEMProcessing</span><span class="p">(</span><span class="s1">&#39;slope.tif&#39;</span><span class="p">,</span> <span class="n">DEM</span><span class="p">,</span> <span class="s1">&#39;slope&#39;</span><span class="p">)</span>
     <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;slope.tif&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
          <span class="n">slope</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">slope</span>


<span class="n">slope</span><span class="o">=</span><span class="n">calculate_slope</span><span class="p">(</span><span class="s2">&quot;/Users/student/Desktop/TestDEM.tif&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;copper&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="aspect-mapping">
<h2><span class="section-number">14.5. </span>Aspect Mapping<a class="headerlink" href="#aspect-mapping" title="Permalink to this heading"></a></h2>
<p><strong>Calculate Aspect Using Arcpy</strong></p>
<p>The script below show how to generate an aspect map using ArcPy.</p>
<ol class="arabic simple">
<li><p>Calculate Aspect</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import system modules</span>
<span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>
<span class="kn">from</span> <span class="nn">arcpy.sa</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Set environment settings</span>
<span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/.../data&quot;</span>

<span class="c1"># Set local variables</span>
<span class="n">inRaster</span> <span class="o">=</span> <span class="s2">&quot;elevation&quot;</span>

<span class="c1"># Execute Aspect</span>
<span class="n">outAspect</span> <span class="o">=</span> <span class="n">Aspect</span><span class="p">(</span><span class="n">inRaster</span><span class="p">)</span>  <span class="c1"># Aspect tool</span>

<span class="c1"># Save the output</span>
<span class="n">outAspect</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;C:/sapyexamples/output/outaspect02&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Generate Aspect Using the GDAL Library</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">rasterio</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="k">def</span> <span class="nf">calculate_aspect</span><span class="p">(</span><span class="n">DEM</span><span class="p">):</span>
       <span class="n">gdal</span><span class="o">.</span><span class="n">DEMProcessing</span><span class="p">(</span><span class="s1">&#39;aspect.tif&#39;</span><span class="p">,</span> <span class="n">DEM</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">)</span>
              <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;aspect.tif&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">dataset</span><span class="p">:</span>
              <span class="n">aspect</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">return</span> <span class="n">aspect</span>

<span class="n">aspect</span><span class="o">=</span><span class="n">calculate_aspect</span><span class="p">(</span><span class="s2">&quot;/Users/.../TestDEM.tif&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspect</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;copper&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>For more information, please see this website - <a class="reference external" href="https://richdem.readthedocs.io/en/latest/terrain_attributes.html">https://richdem.readthedocs.io/en/latest/terrain_attributes.html</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Generate Aspect Using the RichDEM Library</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">richdem</span> <span class="k">as</span> <span class="nn">rd</span>

<span class="n">dem</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">LoadGDAL</span><span class="p">(</span><span class="s1">&#39;/Users/.../elevation&#39;</span><span class="p">)</span>

<span class="n">aspect</span> <span class="o">=</span> <span class="n">rd</span><span class="o">.</span><span class="n">TerrainAttribute</span><span class="p">(</span><span class="n">dem</span><span class="p">,</span> <span class="n">attrib</span><span class="o">=</span><span class="s1">&#39;aspect&#39;</span><span class="p">)</span>
<span class="n">rd</span><span class="o">.</span><span class="n">rdShow</span><span class="p">(</span><span class="n">aspect</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Aspect Map" src="_images/rich_dem_aspect.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="curvature-maps">
<h2><span class="section-number">14.6. </span>Curvature Maps<a class="headerlink" href="#curvature-maps" title="Permalink to this heading"></a></h2>
<p><strong>Generate Curvature Maps Using Arcpy</strong></p>
<p>The first two scripts below show how to calculate curvature using ArcPy.  The third script shows how to compute profile with the richdem library.</p>
<ol class="arabic simple">
<li><p>Curvature Example for Use in ArcGIS Python Window</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">arcpy.ia</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">out_curvature_raster</span> <span class="o">=</span> <span class="n">Curvature</span><span class="p">(</span><span class="s2">&quot;curvature_input.tif&quot;</span><span class="p">,</span> <span class="s2">&quot;profile&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">out_curvature_raster</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;C:/.../curvature.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Curvature Example for Arcpy</p></li>
</ol>
<p>This example calculates the curvature of a given slope. Use in Idle or Python Notebook</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import system modules</span>
<span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy.ia</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Set the analysis environments</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s2">&quot;C:/data&quot;</span>

<span class="c1"># Set the local variables</span>
<span class="n">in_raster</span> <span class="o">=</span> <span class="s2">&quot;curvature_input.tif&quot;</span>

<span class="c1"># Execute Curvature function</span>
<span class="n">out_curvature_raster</span> <span class="o">=</span> <span class="n">Curvature</span><span class="p">(</span><span class="n">in_raster</span><span class="p">,</span> <span class="s2">&quot;planform&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Save the output</span>
<span class="n">out_curvature_raster</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;C:/data/outputs/cur_planform.tif&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Click on the hyperlink for more code samples - <a class="reference external" href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst">https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Curvature Script for RichDem</p></li>
</ol>
<p>port richdem as rd
import matplotlib.pyplot as plt</p>
<p>dem = rd.LoadGDAL(‘/Users/…/Stowe_Dataset/elevation’)
#dem = rasterio.open(‘/Users/…/Stowe_Dataset/elevation’)</p>
<p>profile_curvature = rd.TerrainAttribute(dem, attrib=’profile_curvature’)
rd.rdShow(profile_curvature, axes=False, cmap=’jet’, figsize=(6,4))</p>
<p>plt.show()</p>
<img alt="Aspect Map" src="_images/profile_curvature.png" />
<p>Note: When working with the RichDEM library, valid attributes are: slope_riserun, slope_percentage, slope_degrees, slope_radians, aspect, curvature, planform_curvature, profile_curvature
|</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="computing-viewshed">
<h2><span class="section-number">14.7. </span>Computing Viewshed<a class="headerlink" href="#computing-viewshed" title="Permalink to this heading"></a></h2>
<p><strong>Viewshed Using Arcpy</strong></p>
<p>This sample script comes from <a class="reference external" href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/3d-analyst/viewshed.htm">ESRI</a>. It calculates surface locations that are visible to a set of observers defined in a shapefile. The script requires the 3D Analyst Extension</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arcpy</span>
<span class="kn">from</span> <span class="nn">arcpy</span> <span class="kn">import</span> <span class="n">env</span>

<span class="c1"># Set environment settings</span>
<span class="n">env</span><span class="o">.</span><span class="n">workspace</span> <span class="o">=</span> <span class="s2">&quot;C:/data&quot;</span>

<span class="c1"># Set local variables</span>
<span class="n">inRaster</span> <span class="o">=</span> <span class="s2">&quot;elevation&quot;</span>
<span class="n">inObserverFeatures</span> <span class="o">=</span> <span class="s2">&quot;observers.shp&quot;</span>
<span class="n">outViewshed</span> <span class="o">=</span> <span class="s2">&quot;C:/output/outvwshd02&quot;</span>
<span class="n">zFactor</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">useEarthCurvature</span> <span class="o">=</span> <span class="s2">&quot;CURVED_EARTH&quot;</span>
<span class="n">refractivityCoefficient</span> <span class="o">=</span> <span class="mf">0.15</span>

<span class="c1"># Execute Viewshed</span>
<span class="n">arcpy</span><span class="o">.</span><span class="n">ddd</span><span class="o">.</span><span class="n">Viewshed</span><span class="p">(</span><span class="n">inRaster</span><span class="p">,</span> <span class="n">inObserverFeatures</span><span class="p">,</span> <span class="n">outViewshed</span><span class="p">,</span> <span class="n">zFactor</span><span class="p">,</span>
   <span class="n">useEarthCurvature</span><span class="p">,</span> <span class="n">refractivityCoefficient</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="watershed-delineation-using-pysheds">
<h2><span class="section-number">14.8. </span>Watershed Delineation Using PySheds<a class="headerlink" href="#watershed-delineation-using-pysheds" title="Permalink to this heading"></a></h2>
<p>I came across a library called pysheds that can be used for watershed delineation. Tested sample code is presented below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysheds.grid</span> <span class="kn">import</span> <span class="n">Grid</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="o">.</span><span class="n">from_raster</span><span class="p">(</span><span class="s1">&#39;/Users/.../Stowe_Dataset/elevation&#39;</span><span class="p">)</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">read_raster</span><span class="p">(</span><span class="s1">&#39;/Users/.../Stowe_Dataset/elevation&#39;</span><span class="p">)</span>


<span class="c1"># Fill Sinks</span>
<span class="c1"># ----------------------</span>
<span class="c1"># Fill pits in DEM</span>
<span class="n">pit_filled_dem</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">fill_pits</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span>

<span class="c1"># Fill depressions in DEM</span>
<span class="n">flooded_dem</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">fill_depressions</span><span class="p">(</span><span class="n">pit_filled_dem</span><span class="p">)</span>

<span class="c1"># Resolve flats in DEM</span>
<span class="n">inflated_dem</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">resolve_flats</span><span class="p">(</span><span class="n">flooded_dem</span><span class="p">)</span>


<span class="c1"># Determine D8 flow directions from DEM</span>
<span class="c1"># ----------------------</span>
<span class="c1"># Specify directional mapping</span>
<span class="n">dirmap</span> <span class="o">=</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

<span class="c1"># Compute flow directions</span>
<span class="c1"># -------------------------------------</span>
<span class="n">fdir</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">flowdir</span><span class="p">(</span><span class="n">inflated_dem</span><span class="p">,</span> <span class="n">dirmap</span><span class="o">=</span><span class="n">dirmap</span><span class="p">)</span>


<span class="c1"># Calculate flow accumulation</span>
<span class="c1"># --------------------------</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">accumulation</span><span class="p">(</span><span class="n">fdir</span><span class="p">,</span> <span class="n">dirmap</span><span class="o">=</span><span class="n">dirmap</span><span class="p">)</span>


<span class="c1"># Delineate a catchment</span>
<span class="c1"># ---------------------</span>
<span class="c1"># Specify pour point</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mf">97.294</span><span class="p">,</span> <span class="mf">32.737</span>

<span class="c1"># Snap pour point to high accumulation cell</span>
<span class="n">x_snap</span><span class="p">,</span> <span class="n">y_snap</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">snap_to_mask</span><span class="p">(</span><span class="n">acc</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

<span class="c1"># Delineate the catchment</span>
<span class="n">catch</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">catchment</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_snap</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_snap</span><span class="p">,</span> <span class="n">fdir</span><span class="o">=</span><span class="n">fdir</span><span class="p">,</span> <span class="n">dirmap</span><span class="o">=</span><span class="n">dirmap</span><span class="p">,</span>
         <span class="n">xytype</span><span class="o">=</span><span class="s1">&#39;coordinate&#39;</span><span class="p">)</span>



<span class="c1"># Crop the catchment</span>
<span class="c1"># ---------------------------</span>
<span class="c1"># Clip the bounding box to the catchment</span>
<span class="n">grid</span><span class="o">.</span><span class="n">clip_to</span><span class="p">(</span><span class="n">catch</span><span class="p">)</span>
<span class="n">clipped_catch</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">catch</span><span class="p">)</span>


<span class="c1"># Extract river network</span>
<span class="c1"># ---------------------</span>
<span class="n">branches</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">extract_river_network</span><span class="p">(</span><span class="n">fdir</span><span class="p">,</span> <span class="n">acc</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">,</span> <span class="n">dirmap</span><span class="o">=</span><span class="n">dirmap</span><span class="p">)</span>


<span class="c1"># Calculate distance to outlet from each cell</span>
<span class="c1"># -------------------------------------------</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">distance_to_outlet</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_snap</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_snap</span><span class="p">,</span> <span class="n">fdir</span><span class="o">=</span><span class="n">fdir</span><span class="p">,</span> <span class="n">dirmap</span><span class="o">=</span><span class="n">dirmap</span><span class="p">,</span>
       <span class="n">xytype</span><span class="o">=</span><span class="s1">&#39;coordinate&#39;</span><span class="p">)</span>



<span class="c1"># Plot the catchment</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">clipped_catch</span><span class="p">,</span> <span class="n">clipped_catch</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span> <span class="n">extent</span><span class="o">=</span><span class="n">grid</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
               <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys_r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Delineated Catchment&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
<p>Source: <a class="reference external" href="http://mattbartos.com/pysheds/">http://mattbartos.com/pysheds/</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="working-with-gdal-command-line-utilities">
<h2><span class="section-number">14.9. </span>Working with GDAL Command Line Utilities<a class="headerlink" href="#working-with-gdal-command-line-utilities" title="Permalink to this heading"></a></h2>
<p>GDAL (Geospatial Data Abstraction Library) is perhaps the most established library for reading and processing raster and vector geographical data. It is used by many GIS including ArcGIS and QGIS.  GDAL is written in the C++ programming language, but bindings are available that allow it to called from other languages.</p>
<p>GDAL also has some special programs called <a class="reference external" href="https://gdal.org/programs/index.html">Utilities</a>, which are useful for performing many popular GIS tasks.  These utilities can be called from the command line assuming that proper path is set. They can also be from within Python.  In this section, we will look at how to call GDAL Utilities from the command line.  In the next section, we will look at calling GDAL from within Python.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Getting Information about a Raster</strong></p>
<p>Let’s try the gdalifo command which can be executed from the command prompt. Gdalifo returns a lengthy list of details about the raster.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $ gdalinfo /Users/.../WhiteadderDEM.tif
</pre></div>
</div>
<p>The results are shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Driver</span><span class="p">:</span> <span class="n">AIG</span><span class="o">/</span><span class="n">Arc</span><span class="o">/</span><span class="n">Info</span> <span class="n">Binary</span> <span class="n">Grid</span>
<span class="n">Files</span><span class="p">:</span> <span class="o">/</span><span class="n">Users</span><span class="o">/.../</span><span class="n">Desktop</span><span class="o">/</span><span class="n">Stowe_Dataset</span><span class="o">/</span><span class="n">elevation</span>
<span class="n">Size</span> <span class="ow">is</span> <span class="mi">775</span><span class="p">,</span> <span class="mi">756</span>
<span class="n">Coordinate</span> <span class="n">System</span> <span class="ow">is</span><span class="p">:</span>
<span class="n">PROJCRS</span><span class="p">[</span><span class="s2">&quot;unnamed&quot;</span><span class="p">,</span>
    <span class="n">BASEGEOGCRS</span><span class="p">[</span><span class="s2">&quot;NAD83&quot;</span><span class="p">,</span>
        <span class="n">DATUM</span><span class="p">[</span><span class="s2">&quot;North American Datum 1983&quot;</span><span class="p">,</span>
            <span class="n">ELLIPSOID</span><span class="p">[</span><span class="s2">&quot;GRS 1980&quot;</span><span class="p">,</span><span class="mi">6378137</span><span class="p">,</span><span class="mf">298.257222101</span><span class="p">,</span>
                <span class="n">LENGTHUNIT</span><span class="p">[</span><span class="s2">&quot;metre&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">]]],</span>
        <span class="n">PRIMEM</span><span class="p">[</span><span class="s2">&quot;Greenwich&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">ANGLEUNIT</span><span class="p">[</span><span class="s2">&quot;degree&quot;</span><span class="p">,</span><span class="mf">0.0174532925199433</span><span class="p">]],</span>
        <span class="n">ID</span><span class="p">[</span><span class="s2">&quot;EPSG&quot;</span><span class="p">,</span><span class="mi">4269</span><span class="p">]],</span>
    <span class="n">CONVERSION</span><span class="p">[</span><span class="s2">&quot;unnamed&quot;</span><span class="p">,</span>
        <span class="n">METHOD</span><span class="p">[</span><span class="s2">&quot;Transverse Mercator&quot;</span><span class="p">,</span>
            <span class="n">ID</span><span class="p">[</span><span class="s2">&quot;EPSG&quot;</span><span class="p">,</span><span class="mi">9807</span><span class="p">]],</span>
        <span class="n">PARAMETER</span><span class="p">[</span><span class="s2">&quot;Latitude of natural origin&quot;</span><span class="p">,</span><span class="mf">42.5</span><span class="p">,</span>
            <span class="n">ANGLEUNIT</span><span class="p">[</span><span class="s2">&quot;degree&quot;</span><span class="p">,</span><span class="mf">0.0174532925199433</span><span class="p">],</span>
            <span class="n">ID</span><span class="p">[</span><span class="s2">&quot;EPSG&quot;</span><span class="p">,</span><span class="mi">8801</span><span class="p">]],</span>
        <span class="n">PARAMETER</span><span class="p">[</span><span class="s2">&quot;Longitude of natural origin&quot;</span><span class="p">,</span><span class="o">-</span><span class="mf">72.5</span><span class="p">,</span>
            <span class="n">ANGLEUNIT</span><span class="p">[</span><span class="s2">&quot;degree&quot;</span><span class="p">,</span><span class="mf">0.0174532925199433</span><span class="p">],</span>
            <span class="n">ID</span><span class="p">[</span><span class="s2">&quot;EPSG&quot;</span><span class="p">,</span><span class="mi">8802</span><span class="p">]],</span>
        <span class="n">PARAMETER</span><span class="p">[</span><span class="s2">&quot;Scale factor at natural origin&quot;</span><span class="p">,</span><span class="mf">0.999964286</span><span class="p">,</span>
            <span class="n">SCALEUNIT</span><span class="p">[</span><span class="s2">&quot;unity&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">ID</span><span class="p">[</span><span class="s2">&quot;EPSG&quot;</span><span class="p">,</span><span class="mi">8805</span><span class="p">]],</span>
        <span class="n">PARAMETER</span><span class="p">[</span><span class="s2">&quot;False easting&quot;</span><span class="p">,</span><span class="mi">500000</span><span class="p">,</span>
            <span class="n">LENGTHUNIT</span><span class="p">[</span><span class="s2">&quot;METERS&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">ID</span><span class="p">[</span><span class="s2">&quot;EPSG&quot;</span><span class="p">,</span><span class="mi">8806</span><span class="p">]],</span>
        <span class="n">PARAMETER</span><span class="p">[</span><span class="s2">&quot;False northing&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">LENGTHUNIT</span><span class="p">[</span><span class="s2">&quot;METERS&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">ID</span><span class="p">[</span><span class="s2">&quot;EPSG&quot;</span><span class="p">,</span><span class="mi">8807</span><span class="p">]]],</span>
    <span class="n">CS</span><span class="p">[</span><span class="n">Cartesian</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">AXIS</span><span class="p">[</span><span class="s2">&quot;easting&quot;</span><span class="p">,</span><span class="n">east</span><span class="p">,</span>
            <span class="n">ORDER</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">LENGTHUNIT</span><span class="p">[</span><span class="s2">&quot;METERS&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span>
        <span class="n">AXIS</span><span class="p">[</span><span class="s2">&quot;northing&quot;</span><span class="p">,</span><span class="n">north</span><span class="p">,</span>
            <span class="n">ORDER</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="n">LENGTHUNIT</span><span class="p">[</span><span class="s2">&quot;METERS&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span>
<span class="n">Data</span> <span class="n">axis</span> <span class="n">to</span> <span class="n">CRS</span> <span class="n">axis</span> <span class="n">mapping</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<span class="n">Origin</span> <span class="o">=</span> <span class="p">(</span><span class="mf">470957.412858718482312</span><span class="p">,</span><span class="mf">231421.559170683787670</span><span class="p">)</span>
<span class="n">Pixel</span> <span class="n">Size</span> <span class="o">=</span> <span class="p">(</span><span class="mf">30.680581002795002</span><span class="p">,</span><span class="o">-</span><span class="mf">30.680581002795002</span><span class="p">)</span>
<span class="n">Metadata</span><span class="p">:</span>
  <span class="n">DataType</span><span class="o">=</span><span class="n">Generic</span>
<span class="n">Corner</span> <span class="n">Coordinates</span><span class="p">:</span>
<span class="n">Upper</span> <span class="n">Left</span>  <span class="p">(</span>  <span class="mf">470957.413</span><span class="p">,</span>  <span class="mf">231421.559</span><span class="p">)</span> <span class="p">(</span> <span class="mi">72</span><span class="n">d51</span><span class="s1">&#39;56.55&quot;W, 44d34&#39;</span><span class="mf">56.75</span><span class="s2">&quot;N)</span>
<span class="n">Lower</span> <span class="n">Left</span>  <span class="p">(</span>  <span class="mf">470957.413</span><span class="p">,</span>  <span class="mf">208227.040</span><span class="p">)</span> <span class="p">(</span> <span class="mi">72</span><span class="n">d51</span><span class="s1">&#39;51.86&quot;W, 44d22&#39;</span><span class="mf">25.30</span><span class="s2">&quot;N)</span>
<span class="n">Upper</span> <span class="n">Right</span> <span class="p">(</span>  <span class="mf">494734.863</span><span class="p">,</span>  <span class="mf">231421.559</span><span class="p">)</span> <span class="p">(</span> <span class="mi">72</span><span class="n">d33</span><span class="s1">&#39;58.68&quot;W, 44d34&#39;</span><span class="mf">58.78</span><span class="s2">&quot;N)</span>
<span class="n">Lower</span> <span class="n">Right</span> <span class="p">(</span>  <span class="mf">494734.863</span><span class="p">,</span>  <span class="mf">208227.040</span><span class="p">)</span> <span class="p">(</span> <span class="mi">72</span><span class="n">d33</span><span class="s1">&#39;57.83&quot;W, 44d22&#39;</span><span class="mf">27.33</span><span class="s2">&quot;N)</span>
<span class="n">Center</span>      <span class="p">(</span>  <span class="mf">482846.138</span><span class="p">,</span>  <span class="mf">219824.300</span><span class="p">)</span> <span class="p">(</span> <span class="mi">72</span><span class="n">d42</span><span class="s1">&#39;56.23&quot;W, 44d28&#39;</span><span class="mf">42.39</span><span class="s2">&quot;N)</span>
<span class="n">Band</span> <span class="mi">1</span> <span class="n">Block</span><span class="o">=</span><span class="mi">256</span><span class="n">x16</span> <span class="n">Type</span><span class="o">=</span><span class="n">Float32</span><span class="p">,</span> <span class="n">ColorInterp</span><span class="o">=</span><span class="n">Undefined</span>
  <span class="n">Description</span> <span class="o">=</span> <span class="n">elevation</span>
  <span class="n">Min</span><span class="o">=</span><span class="mf">133.493</span> <span class="n">Max</span><span class="o">=</span><span class="mf">1335.372</span>
  <span class="n">Minimum</span><span class="o">=</span><span class="mf">134.525</span><span class="p">,</span> <span class="n">Maximum</span><span class="o">=</span><span class="mf">1333.913</span><span class="p">,</span> <span class="n">Mean</span><span class="o">=</span><span class="mf">476.449</span><span class="p">,</span> <span class="n">StdDev</span><span class="o">=</span><span class="mf">214.550</span>
  <span class="n">NoData</span> <span class="n">Value</span><span class="o">=-</span><span class="mf">3.4028234663852886e+38</span>
  <span class="n">Overviews</span><span class="p">:</span> <span class="mi">388</span><span class="n">x378</span><span class="p">,</span> <span class="mi">194</span><span class="n">x189</span>
  <span class="n">Metadata</span><span class="p">:</span>
    <span class="n">RepresentationType</span><span class="o">=</span><span class="n">ATHEMATIC</span>
    <span class="n">STATISTICS_APPROXIMATE</span><span class="o">=</span><span class="n">YES</span>
    <span class="n">STATISTICS_MAXIMUM</span><span class="o">=</span><span class="mf">1333.9129638672</span>
    <span class="n">STATISTICS_MEAN</span><span class="o">=</span><span class="mf">476.44892214671</span>
    <span class="n">STATISTICS_MINIMUM</span><span class="o">=</span><span class="mf">134.52473449707</span>
    <span class="n">STATISTICS_STDDEV</span><span class="o">=</span><span class="mf">214.55017815777</span>
    <span class="n">STATISTICS_VALID_PERCENT</span><span class="o">=</span><span class="mf">98.84</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Converting Between Raster Formats</strong></p>
<p>We can convert between raster file formats using the gdal_translate tool. Gdal_translate recognises many file formats. To set the file format, use the ‘-of’ flag. An example of the syntax is shown below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $ gdal_translate -of ENVI  /Users/student/Downloads/WhiteadderDEM.tif  /Users/hsemple/Downloads/WhiteadderDEM.bil
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Clipping Rasters using GDAL</strong></p>
<p>Clipping rasters can be done quite easily using gdal. You can enter the bounding coordinates of the clipping extent or you can supply a raster or vector file as the extent.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $ gdalwarp -te &lt;x_min&gt; &lt;y_min&gt; &lt;x_max&gt; &lt;y_max&gt; input.bil clipped_output.bil
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Merging Rasters using GDAL</strong></p>
<p>If you have large DEMs you can merge them very quickly using GDAL</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $ gdal_merge.py -o out.tif in1.tif in2.tif
</pre></div>
</div>
<p>#The -o flag indicates the outfile.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Changing Raster Projections with Gdalwarp</strong></p>
<p>We can change the underlying projections of rasters using the gdalwarp command.  The gdalwarp command detects the projection of the raster that is to be projected so we do not have enter this value.   The ‘-t_srs’ flag is used to assign the target coordinate system, which must be placed in quotes.  An example of the basic command is shown below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $ gdalwarp -t_srs &#39;+proj=utm +zone=44 +datum=WGS84&#39; projected.tif reprojected.tif
</pre></div>
</div>
<p>See this link for more info: <a class="reference external" href="https://www.geos.ed.ac.uk/~smudd/TopoTutorials/html/tutorial_raster_conversion.html#converting-between-formats-using-gdal">https://www.geos.ed.ac.uk/~smudd/TopoTutorials/html/tutorial_raster_conversion.html#converting-between-formats-using-gdal</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Compute Slope</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $ gdaldem slope inputDem.tif  output_slope.tif
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Make a Colored Relief Map</strong></p>
<p>First, run gdalinfo and get the minimum and maximum elevation of the DEM.  Next, use these values to make some elevation breaks and some corresponding RGB colors for each break. In the example below, the first number in each row represents the upper breakpoint for the color range while the next three values are RGB values.  In the example, echo takes everything between the quotations and places it into a file called color-relief.txt usng the &gt; operator:</p>
<div class="line-block">
<div class="line">echo ‘0 0 0 0</div>
<div class="line">26 110 220 110</div>
<div class="line">51 240 250 160</div>
<div class="line">76 230 220 170</div>
<div class="line">101 220 220 220</div>
<div class="line">127 250 250 250’ &gt; color-relief.txt</div>
</div>
<p>Once the color map file is completed, we can use it generate a colored relief, as shown in the example below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gdaldem</span> <span class="n">color</span><span class="o">-</span><span class="n">relief</span> <span class="o">-</span><span class="n">of</span> <span class="n">PNG</span> <span class="n">sf</span><span class="o">-</span><span class="n">dem</span><span class="o">.</span><span class="n">tif</span> <span class="n">color</span><span class="o">-</span><span class="n">relief</span><span class="o">.</span><span class="n">txt</span> <span class="n">sf</span><span class="o">-</span><span class="n">dem</span><span class="o">-</span><span class="n">coloredRelief</span><span class="o">.</span><span class="n">tif</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>For more information on how to work with GDAL command line utilities, see this website - <a class="reference external" href="https://gdal.org/programs/gdaldem.html">https://gdal.org/programs/gdaldem.html</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Computing Viewsheds</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gdal_viewshed</span> <span class="o">-</span><span class="n">md</span> <span class="mi">500</span> <span class="o">-</span><span class="n">ox</span> <span class="o">-</span><span class="mi">10147017</span> <span class="o">-</span><span class="n">oy</span> <span class="mi">5108065</span> <span class="n">source</span><span class="o">.</span><span class="n">tif</span> <span class="n">destination</span><span class="o">.</span><span class="n">tif</span>
</pre></div>
</div>
<p>The flags have the following meaning:</p>
<dl class="option-list">
<dt><kbd><span class="option">-m<var>d</var></span></kbd></dt>
<dd><p>Maximum distance from observer to compute visibiliy. It is also used to clamp the extent of the output raster.\</p>
</dd>
</dl>
<dl class="simple">
<dt>-ox &lt;value&gt;</dt><dd><p>The X position of the observer (in SRS units).</p>
</dd>
<dt>-oy &lt;value&gt;</dt><dd><p>The Y position of the observer (in SRS units).</p>
</dd>
</dl>
<p>For more information, see <a class="reference external" href="https://man.archlinux.org/man/community/gdal/gdal_viewshed.1.en">https://man.archlinux.org/man/community/gdal/gdal_viewshed.1.en</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="running-gdal-commands-from-python">
<h2><span class="section-number">14.10. </span>Running GDAL Commands from Python<a class="headerlink" href="#running-gdal-commands-from-python" title="Permalink to this heading"></a></h2>
<p>It is possible to call GDAL commands from Python and other scripting languages. This allows for easy iteration through geoprocessing tasks, or integration of geoprocessing steps into complex scripted workflows.  For more information, please visit this page: <a class="reference external" href="https://gdal.org/tutorials/raster_api_tut.html">https://gdal.org/tutorials/raster_api_tut.html</a>. Below are some code samples for using GDAL from within Python.</p>
<p><strong>Open a Raster with GDAL</strong></p>
<p>We have already seen this structure in previous Python scripts that used the gdal library.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">gdal</span>
<span class="n">fn</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot; /Users/student/Desktop/Stowe_Dataset/elevation&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span> <span class="c1"># 0 (default) read-only, 1 update</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ds</span><span class="p">))</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Get Raster Properties</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fn_dem</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;..\data\input\USGS_one_meter_x64y486_ID_FEMAHQ_2018.tif&quot;</span>
<span class="n">fn_img</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;..\data\input\m_4311515_ne_11_1_20150908_20160104.jp2&quot;</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="n">fn_dem</span><span class="p">)</span> <span class="c1"># 2 arguments: (file name, access type: 0 (default) read-only, 1 update)</span>

<span class="n">nrows</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">RasterYSize</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">RasterXSize</span>
<span class="n">proj</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetProjection</span><span class="p">()</span>  <span class="c1"># returns WKT definition</span>
<span class="n">nbands</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">RasterCount</span>
<span class="n">geot</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GetGeoTransform</span><span class="p">()</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="exercises">
<h2><span class="section-number">14.11. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Write a script that prompts the user for the path to an input DEM and an input satellite imagery.  Afterwards, the script should generate a hillshade of the area. Finally, the script should drape the satellite imagery over the hillshade. You can download <a class="reference external" href="https://www.dropbox.com/s/r61wulyhlctvdcf/Washington_Data.zip?dl=0">sample data here</a></p></li>
<li><p>Instead of generating a hillshade, write a second script to generate a 3D model of the area. Afterward, let the script drape a satellite imagery over the 3D model of the area.</p></li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="resources">
<h2><span class="section-number">14.12. </span>Resources<a class="headerlink" href="#resources" title="Permalink to this heading"></a></h2>
<p>Draping an orthophoto over a DEM
<a class="reference external" href="https://subscription.packtpub.com/book/big-data-and-business-intelligence/9781783555079/10/ch10lvl1sec73/draping-an-orthophoto-over-a-dem">https://subscription.packtpub.com/book/big-data-and-business-intelligence/9781783555079/10/ch10lvl1sec73/draping-an-orthophoto-over-a-dem</a></p>
<p>Batch processing – automatizing the use of GDAL and SAGA GIS tools using Bash Shell scripts
<a class="reference external" href="https://www.luisalucchese.com/post/batch-processing-gdal-saga-gis-bash/">https://www.luisalucchese.com/post/batch-processing-gdal-saga-gis-bash/</a></p>
<p>Working with Rasterio
<a class="reference external" href="https://geobgu.xyz/py/rasterio.html">https://geobgu.xyz/py/rasterio.html</a></p>
<p>Popular GDAL commands. <a class="reference external" href="https://github.com/dwtkns/gdal-cheat-sheet">https://github.com/dwtkns/gdal-cheat-sheet</a></p>
<p>Classify a Raster Using Threshold Values in Python - 2017 - <a class="reference external" href="https://www.neonscience.org/resources/learning-hub/tutorials/classify-raster-thresholds-py">https://www.neonscience.org/resources/learning-hub/tutorials/classify-raster-thresholds-py</a>
<a class="reference external" href="https://www.blendernation.com/2016/09/03/owen-powell-maps-terrain-models/">https://www.blendernation.com/2016/09/03/owen-powell-maps-terrain-models/</a></p>
<p>3D Modeling with Matplotlib  - <a class="reference external" href="https://thinkinfi.com/3d-digital-surface-model-with-python-and-pylidar/">https://thinkinfi.com/3d-digital-surface-model-with-python-and-pylidar/</a></p>
<p>Visualizing Topography and Maps with PyVista - <a class="reference external" href="https://gemgis.readthedocs.io/en/latest/getting_started/tutorial/14_visualizing_topography_and_maps_with_pyvista.html">https://gemgis.readthedocs.io/en/latest/getting_started/tutorial/14_visualizing_topography_and_maps_with_pyvista.html</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="spatial_analysis.html" class="btn btn-neutral float-left" title="13. Spatial Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="workflow_automation.html" class="btn btn-neutral float-right" title="15. Batch Processing &amp; Workflow Automation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hugh Semple.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>